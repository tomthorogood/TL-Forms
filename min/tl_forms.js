if(typeof navigator!=="undefined"){var IE_MODE=navigator.appName==="Microsoft Internet Explorer"}String.prototype.toTitleCase=function(){var a=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;return this.replace(/([^\W_]+[^\s\-]*) */g,function(c,f,b,d){if(b>0&&b+f.length!==d.length&&f.search(a)>-1&&d.charAt(b-2)!==":"&&d.charAt(b-1).search(/[^\s\-]/)<0){return c.toLowerCase()}if(f.substr(1).search(/[A-Z]|\../)>-1){return c}return c.charAt(0).toUpperCase()+c.substr(1)})};function Parse(a){if(/::/.test(a)){return a.split(/::/g)}return[a,a]}function Form(){this.parse={value:function(a){return Parse(a)[0]},display:function(a){return Parse(a)[1]},selected:function(a){return Parse(a)[2]}}}Form.prototype.IE_Compliant=function(a){if(IE_MODE){var b=document.createElement("div");b.name=a.name;b.appendChild(a);return b}return a};Form.prototype.create_text_field=function(a,c,b){if(typeof a==="undefined"){a="text_field"}var d=document.createElement("input");d.type="text";d.name=a;d.value=c||"";if(typeof b==="string"){$(d).addClass(b)}return this.IE_Compliant(d)};Form.prototype.create_dropdown_menu=function(b,a,d,g){var i=document.createElement("select");if(typeof b==="undefined"){b="dropdown"}i.name=b;for(var f in a){if(typeof f!=="undefined"){var h=a[f];if(!g||typeof g==="undefined"){h=h.replace(/_/g," ").toTitleCase()}var c=document.createElement("option");c.value=this.parse.value(h);c.innerHTML=this.parse.display(h);i.appendChild(c)}}if(typeof d==="string"){$(i).addClass(d)}return i};Form.prototype.create_password_field=function(a,c,b){if(typeof a==="undefined"){a="password"}var d=document.createElement("input");d.type="password";d.name=a;if(typeof c==="string"){d.value=c}if(typeof b==="string"){$(d).addClass(b)}return this.IE_Compliant(d)};Form.prototype.create_submit_button=function(a,d,c,f){var b;if(typeof d==="undefined"){d="Submit"}if(typeof f==="undefined"){b=document.createElement("input");b.type="submit";b.value=d}else{b=document.createElement("input");b.type="image";b.src=f}if(typeof c==="string"){$(b).addClass(c)}b.name=a||"submit";return this.IE_Compliant(b)};Form.prototype.create_hidden_field=function(a,c){var b=document.createElement("input");b.type="hidden";b.name=a;b.value=c;return b};Form.prototype.create_file_upload=function(b,c){var a=document.createElement("input");a.type="file";a.name=b;if(typeof c==="string"){$(a).addClass(c)}return this.IE_Compliant(a)};Form.create_textarea=function(b,d,c){var a=document.createElement("textarea");if(typeof b==="undefined"){b="textarea"}if(typeof c==="string"){$(a).addClass(c)}if(typeof d==="string"){a.innerHTML=d}return this.IE_Compliant(a)};Form.prototype.create_multi_button=function(c,j,b,h){var a=document.createElement("div");var i;a.name=c;for(i in j){if(typeof i==="string"){var g=document.createElement("div");var k=document.createElement("span");if(typeof b==="string"){$(g).addClass(b)}var f=document.createElement("input");if(typeof c==="undefined"){c=h}f.name=c;f.type=h;f.value=this.parse.value(j[i]);if(this.parse.selected(j[i])==="Selected"){f.checked="checked"}k.innerHTML=this.parse.display(j[i]);g.appendChild(f);g.appendChild(k);a.appendChild(g)}}return a};Form.prototype.create_radio_button=function(b,a,c){return this.create_multi_button(b,a,c,"radio")};Form.prototype.create_checkbox=function(b,a,c){return this.create_multi_button(b,a,c,"checkbox")};function Form_Bridge(){this.creator=new Form()}Form_Bridge.prototype.create_text_field=function(a,c,b){return this.creator.create_text_field(a,c,b)};Form_Bridge.prototype.create_hidden_field=function(a,b){return this.creator.create_hidden_field(a,b)};Form_Bridge.prototype.create_dropdown_menu=function(b,a,c){return this.creator.create_dropdown_menu(b,a,c)};Form_Bridge.prototype.create_submit_button=function(a,c,b){return this.creator.create_submit_button(a,c,b)};Form_Bridge.prototype.create_radio_button=function(a,c,b){return this.creator.create_radio_button(a,c,b)};Form_Bridge.prototype.create_textarea=function(a,c,b){return this.creator.create_textarea(a,c,b)};function Element(g,b,h,k,d,j,f){this.form_creator=new Form_Bridge();this.type=g;this.validator_callback=j||function(){return true};this.input=[];this.name=b;this.validator=typeof d!=="undefined"?d:undefined;this.required=typeof f!=="undefined"?f:false;this.valid=!(typeof this.validator!=="undefined"&&this.required===true);switch(this.type){case"text":this.model=this.form_creator.create_text_field(b,h,k);this.tag="input";break;case"hidden":this.model=this.form_creator.create_hidden_field(b,h);this.tag="input";break;case"password":this.model=this.form_creator.create_password_field(b,h,k);this.tag="input";break;case"dropdown":this.model=this.form_creator.create_dropdown_menu(b,h,k);this.tag="select";break;case"submit":this.model=this.form_creator.create_submit_button(b,h,k);this.tag="input";break;case"radio":this.model=this.form_creator.create_radio_button(b,h,k);this.tag="input";break;case"textarea":this.model=this.form_creator.create_textarea(b,h,k);this.tag="textarea"}var a=(this.model.getElementsByTagName(this.tag));for(var c=0;c<a.length;c++){this.input.push(a[e])}if(typeof this.test!=="undefined"){this.validator.validate(this,this.validator_callback)}}function Field_Group(a,c){this.inputs=[];this.field_names=[];this.div=document.createElement("div");$(this.div).addClass("tl form group").hide();for(var b=0;b<c.length;b++){this.div.appendChild(c[b].model);this.inputs.push(c[b].input);this.field_names.push(c[b].name)}}function Validator(b,a,f,d,c){this.ANIMATION_SPEED=f||250;this.DELAY=a||650;this.css={valid:d||{"background-color":"#00afad",color:"#fff"},invalid:c||{"background-color":"#811",color:"#fff"}};this.test=b;this.set_text={};this.validate=function(j){var g=this;var l;var k;if(j.type.toLowerCase()==="radio"){for(var h=0;h<j.input.length;h++){$(j.input[h]).change(function(){return function(){var i=this.value;k=g.test(i);j.valid=k}}.call(this))}}else{$(j).keyup(function(){$(this).keydown(function(i){if(i.keyCode!==9){clearTimeout(l)}});if(typeof j.value!=="undefined"&&j.value.length>0){l=setTimeout(function(){k=g.test(j.input[0].value);switch(typeof k){case"object":g.set_text[j.name]=k[1].toString();k=k[0];case"boolean":var i=k?g.css.valid:g.css.invalid;j.valid=k;break;default:k=true;j.valid=k}$(j.input[0]).animate(i,g.ANIMATION_SPEED,function(){if(typeof g.set_text[j.name]==="string"){j.input[0].value=g.set_text[j.name];delete g.set_text[j.name]}})},g.DELAY)}})}}}function Form_Widget(d,c,b,a){if(!b===true){this.overlay=new Overlay();this.element=this.overlay.div}else{this.element=a}this.method=d;this.handler=c;this.fields=[];this.groups=[];this.validation_timeout=500;this.field_instructions={};this.swap_char_map={_x_:"d"};this.valid={email:new Validator(function(i){var h=/[A-Za-z0-9%._\-]*@[A-Zz-z0-9\-]*\.[a-zA-Z0-9]{2,4}/gi;var g;var f;if(h.test(i)){g=true}switch(g){case true:return true;case false:return[false,"That email address already exists in our system."];default:return false}}),day_in_month:new Validator(function(f){var g=parseInt(f,10);return(typeof g==="number"&&g<32)}),currency:new Validator(function(i){var h=/^\$?([1-9]{1}[0-9]{0,2}(\,[0-9]{3})*(\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\.[0-9]{0,2})?|0(\.[0-9]{0,2})?|(\.[0-9]{1,2})?)$/;var j=h.test(i);if(j){var g=/[$,]/g;var f=i.replace(g,"");return[true,f]}else{return h.test(j)}}),percentage:new Validator(function(i){var h=/^[0-9]{0,2}\.{0,1}[0-9]{0,2}%{0,1}/;var f=/^(\.(\d*))/;var g;if(f.test(i)){as_float=parseFloat(i,10);if(as_float>1){return[true,as_float/100]}return true}else{if(h.test(i)){var g=parseInt(i.replace(/\%/g,""),10);g/=100;return[true,g]}else{return false}}}),password:new Validator(function(g){var f=/\\\/\(\)\{\};/g;var h=6;if(!f.test(g)){if(g.length>=h){return true}else{return false}}else{return false}})}}Form_Widget.prototype.show_progress=function(){var p=this.groups[this.progress.current-1];var l=p.field_names;var o={};var h=true;var g;for(g=0;g<l.length;g++){var b=l[g];var a=[];for(var f=0;f<this.fields.length;f++){if(this.fields[f].name===b){a.push(f)}}for(var d=0;d<a.length;d++){if(this.fields[d].valid===true){o[b]=true;break}else{o[b]=false}}}for(var c=0;c<l.length;c++){if(!o[c]){h=false;break}}if(h===true){$(this.progress.button).show()}};Form_Widget.prototype.validate=function(b,a){this.valid[a].validate(b)};Form_Widget.prototype.add_field=function(b,a,d,c,h,g){var i;if(typeof h!=="undefined"){i=this.valid[h].validate}var f=new Element(b,a,d,c,i,this.show_progress,g);this.fields.push(f)};Form_Widget.prototype.grouping=function(d,a){var c;var b;var g;var f=[];for(c in a){if(typeof a[c]==="string"){for(g in this.fields){if(typeof this.fields[g]==="object"){b=this.field_index(a[c]);f.push(this.fields[b])}}}}this.groups.push(new Field_Group(d,f))};Form_Widget.prototype.progress_button=function(a){this.progress.button=this.format_element(a)};Form_Widget.prototype.enable_progress_button=function(){var a=this;$(a.progress.button).click(function(){$(a.groups[a.group]).hide("slide",{direction:"left"},250,function(){a.group++;$(a.groups[a.group]).show("slide",{direction:"right"},250);if(typeof a.progress.bar!=="undefined"){a._progress()}})});$(this.progress.button).hide()};Form_Widget.prototype.name_swap=function(c){var a;for(a in this.swap_char_map){if(typeof this.swap_char_map[a]==="string"){var b=new RegExp(a);if(b.test(c)){return c.replace(b,this.swap_char_map[a])}}}return c};Form_Widget.prototype.create_form=function(b,h){var a=this;var k;var d=document.createElement("form");if(typeof b!=="undefined"){d.id=b}if(typeof h!=="undefined"){d.className=h}d.setAttribute("method",this.method);d.setAttribute("action",this.handler);if(this.groups.length===0){for(k in this.fields){var i=this.fields[k];if(typeof i==="object"){d.appendChild(i)}}}else{for(var j in this.groups){var c=this.groups[j];if(typeof c==="object"){d.appendChild(c.div)}}this.group=0;$(this.groups[this.group].div).show("slide",{direction:"right"},250);this.enable_progress_button();if(this.progress.end===0){this.progress.end=this.groups.length}this.initialize_progress()}$("input[type=text]",d).one("focus",function(){$(this).val("")});this.element.appendChild(d);$(".swap.focus").hide();$(".swap.default").one("focus",function(){var f=this.name;var g=a.name_swap(f);$(this).remove();$("input[name="+g+"]").show().focus();return false})};Form_Widget.prototype.format_element=function(a){if(typeof a==="object"){return a}if(a[0]!=="#"){a="#"+a}return $(a)};Form_Widget.prototype.set_ajax=function(a,b){if(a===true){$("form",this.element).submit(function(){var c={success:b};$(this).ajaxSubmit(c);return false})}else{$("form",this.element).unbind("submit")}};Form_Widget.prototype.track_progress=function(b,a){this.progress={container:b,bar:a,speed:250,tracking:true,start:0,current:1,end:0}};Form_Widget.prototype._progress=function(){var a=100;this.progress.current++;var c=this.progress.speed;var b=Math.floor((this.progress.current/this.progress.end)*a);$(this.progress.bar).animate({width:b+"%"},c);if(this.group===this.groups.length-1){$(this.progress.button).hide()}$(this.instructions).hide("slide",{direction:"left"},150)};Form_Widget.prototype.initialize_progress=function(){var a=this.progress.start;$(this.progress.bar).css({width:a+"%"})};Form_Widget.prototype.add_instructions=function(a,b){this.field_instructions[a]=b};Form_Widget.prototype.field_index=function(b){for(var a=0;a<this.fields.length;a++){if(this.fields[a].model.name===b){return a}}return undefined};Form_Widget.prototype.add_text=function(b,c){var a=this.field_index(b);var d=document.createElement("div");d.innerHTML=c;d.appendChild(this.fields[a]);d.name=this.fields[a].name;$(d).addClass("form flavor");this.fields[a]=d};Form_Widget.prototype.set_instructions=function(b){var a=this;if(typeof b==="string"){if(typeof document.getElementById(b.replace(/#/,""))==="undefined"){this.instructions=document.createElement("div");this.instructions.id=b.replace(/#/,"");b=this.instructions}else{b=document.getElementById(b.replace(/#/,""));this.instructions=b}}if(this.groups.length===0){var d;$.each(this.fields,function(g,f){$(f).focus(function(){var h=$(f).attr("name");$(b).hide("slide",{direction:"left"},150,function(){$(this).empty().text(a.field_instructions[h]);$(this).show("slide",{direction:"right"},150)})})})}else{var c;for(c in this.groups){$(this.groups[c]).children().each(function(){$(this).focus(function(){var f=this.name;$(b).hide("slide",{direction:"left"},150,function(){$(this).empty().html(a.field_instructions[f]);$(this).show("slide",{direction:"right"},150)})})})}}};